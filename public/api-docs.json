{
  "openapi": "3.0.0",
  "info": {
    "title": "REST API Справочника Организаций",
    "description": "API для работы со справочником организаций, зданий и деятельностей",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "http://localhost:81/api",
      "description": "Локальный сервер разработки"
    }
  ],
  "components": {
    "securitySchemes": {
      "ApiKeyAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "X-API-Key"
      }
    },
    "schemas": {
      "Organization": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "description": "ID организации"
          },
          "name": {
            "type": "string",
            "description": "Название организации"
          },
          "phones": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Список телефонов"
          },
          "activities": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Список видов деятельности"
          },
          "building": {
            "type": "object",
            "properties": {
              "id": {
                "type": "integer"
              },
              "address": {
                "type": "string"
              },
              "latitude": {
                "type": "number",
                "format": "float"
              },
              "longitude": {
                "type": "number",
                "format": "float"
              }
            }
          }
        }
      },
      "Building": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "address": {
            "type": "string"
          },
          "latitude": {
            "type": "number",
            "format": "float"
          },
          "longitude": {
            "type": "number",
            "format": "float"
          },
          "organizations_count": {
            "type": "integer"
          },
          "organizations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Organization"
            }
          }
        }
      },
      "ApiResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Organization"
            }
          }
        }
      }
    }
  },
  "security": [
    {
      "ApiKeyAuth": []
    }
  ],
  "paths": {
    "/buildings": {
      "get": {
        "summary": "Список всех зданий",
        "description": "Возвращает список всех зданий с информацией об организациях",
        "tags": ["Здания"],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Building"
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Неверный API ключ"
          }
        }
      }
    },
    "/buildings/{id}": {
      "get": {
        "summary": "Информация о здании",
        "description": "Возвращает подробную информацию о здании по ID",
        "tags": ["Здания"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID здания"
          }
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "$ref": "#/components/schemas/Building"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Здание не найдено"
          }
        }
      }
    },
    "/organizations/building/{buildingId}": {
      "get": {
        "summary": "Организации в здании",
        "description": "Возвращает список всех организаций в конкретном здании",
        "tags": ["Организации"],
        "parameters": [
          {
            "name": "buildingId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID здания"
          }
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          }
        }
      }
    },
    "/organizations/activity/{activityId}": {
      "get": {
        "summary": "Организации по деятельности",
        "description": "Возвращает список организаций, занимающихся указанным видом деятельности (включая дочерние)",
        "tags": ["Организации"],
        "parameters": [
          {
            "name": "activityId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID вида деятельности"
          }
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          }
        }
      }
    },
    "/organizations/radius": {
      "get": {
        "summary": "Организации в радиусе",
        "description": "Возвращает организации в заданном радиусе от указанной точки",
        "tags": ["Организации"],
        "parameters": [
          {
            "name": "latitude",
            "in": "query",
            "required": true,
            "schema": {
              "type": "number",
              "format": "float",
              "minimum": -90,
              "maximum": 90
            },
            "description": "Широта центральной точки"
          },
          {
            "name": "longitude",
            "in": "query",
            "required": true,
            "schema": {
              "type": "number",
              "format": "float",
              "minimum": -180,
              "maximum": 180
            },
            "description": "Долгота центральной точки"
          },
          {
            "name": "radius",
            "in": "query",
            "required": true,
            "schema": {
              "type": "number",
              "format": "float",
              "minimum": 0.1,
              "maximum": 100
            },
            "description": "Радиус поиска в километрах"
          }
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          }
        }
      }
    },
    "/organizations/area": {
      "get": {
        "summary": "Организации в области",
        "description": "Возвращает организации в прямоугольной области",
        "tags": ["Организации"],
        "parameters": [
          {
            "name": "min_lat",
            "in": "query",
            "required": true,
            "schema": {
              "type": "number",
              "format": "float",
              "minimum": -90,
              "maximum": 90
            },
            "description": "Минимальная широта"
          },
          {
            "name": "max_lat",
            "in": "query",
            "required": true,
            "schema": {
              "type": "number",
              "format": "float",
              "minimum": -90,
              "maximum": 90
            },
            "description": "Максимальная широта"
          },
          {
            "name": "min_lng",
            "in": "query",
            "required": true,
            "schema": {
              "type": "number",
              "format": "float",
              "minimum": -180,
              "maximum": 180
            },
            "description": "Минимальная долгота"
          },
          {
            "name": "max_lng",
            "in": "query",
            "required": true,
            "schema": {
              "type": "number",
              "format": "float",
              "minimum": -180,
              "maximum": 180
            },
            "description": "Максимальная долгота"
          }
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          }
        }
      }
    },
    "/organizations/search": {
      "get": {
        "summary": "Поиск организаций по названию",
        "description": "Поиск организаций по части названия",
        "tags": ["Организации"],
        "parameters": [
          {
            "name": "name",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 2
            },
            "description": "Часть названия для поиска"
          }
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiResponse"
                }
              }
            }
          }
        }
      }
    },
    "/organizations/{id}": {
      "get": {
        "summary": "Информация об организации",
        "description": "Возвращает подробную информацию об организации по ID",
        "tags": ["Организации"],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "ID организации"
          }
        ],
        "responses": {
          "200": {
            "description": "Успешный ответ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "$ref": "#/components/schemas/Organization"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Организация не найдена"
          }
        }
      }
    }
  }
} 